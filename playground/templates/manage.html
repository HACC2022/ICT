{%extends "base.html"%}

{%block content %}

<style>
    .button{
        background-color: rgb(187, 0, 0);
        border-color: rgb(187, 0, 0);
        border-radius: 10%;
        box-shadow: none;
        color: white;
    }
    .button:hover {
      background-color:rgb(255, 145, 145);
      border-color: rgb(255, 145, 145);
      color: black;
      transition: 0.1s;
  }
</style>

<div class="row" style="padding-left: 30px; padding-top: 30px;">
    <div class="col">
        <input type="search-field" class="form-control" placeholder="Type here to Search" >
    </div>
    <div class="col">
        <button type="search-btn" class="btn btn-primary">Search</button>
    </div>
</div>

<div class="table-responsive" style="padding: 30px;">
    <table class="table">
        <thead>
            <tr>
                <th></th>
                <th class="col-3">Short URL</th>
                <th class="col-9" style="border-left-style: solid;">Long URL</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {%for instance in object_list %}
            <tr class = "record">
                <td><button type="copy" class="btn btn-primary" style="height:35px;">Copy</button></td>
                <td class="col-3">localhost:8000/{{instance.shortCode}}</td>
                <td class="col-9" style="border-left-style: solid;">{{instance.longLink}}</td>
                <td><a href="{%url 'delete_data' instance.id%}" type = "button" id = "delete" class="button nav-link delete" style="height:35px; opacity: 100%;">Delete</a></td>
            </tr>
            {%endfor %}
        </tbody>
    </table>
</div>

<script>
    $(".delete").on("click", function(e){
        e.preventDefault();
        var $this = $(this);
        if (confirm("Are you Fucking Sure?")){
            $.ajax({
                url: $this.attr("href"),
                type: "GET",
                dataType: "json",
                success: function(resp){
                    if (resp.message === 'success'){
                        $this.parents('.record').fadeOut("slow", function(){
                            $this.parents('.record').remove();
                        });
                    }
                    else{
                        alert(resp.message);
                    }
                },
                error: function(resp){
                    console.log("something is wrong");
                }
            });
        }
        return false;
    })
</script>

{%endblock%}